/* v6 */
if(gnc){}else{var gnc={}}gnc.productPage={};Event.observe(window,"load",function(){var a;if(gnc!=null){$$('input[name="purchaseType"]').each(function(b){a=$(b);if(a.checked){if(a.value=="autoship"){gnc.toggleActivePurchaseType("autoContainer")}else{if(a.value=="individual"){gnc.toggleActivePurchaseType("individualContainer")}}}if($("savingsPerUnit")!=null){gnc.setSavingsPerYear()}})}});gnc.setSavingsPerYear=function(){var b=$("savingsPerUnit").value;var c=$("autoShipFrequencySelect").value;var d=Math.round(365/c);var a=Math.round(d*b*100)/100;if($("freqSavings")!=null){$("freqSavings").update("$"+a)}};gnc.radioButtonSelected=function(c){if(c.target){element=c.target}else{if(c.srcElement){element=c.srcElement}}var a="autoShipFrequencySelect";var b="prod_0";var d="recprod";if(element.value=="autoship"){$(a).style.visibility="visible";$(b).value=$(d).value;gnc.toggleActivePurchaseType("autoContainer")}else{if(element.value=="individual"){$(a).style.visibility="hidden";gnc.toggleActivePurchaseType("individualContainer")}}return true};gnc.toggleActivePurchaseType=function(a){var f;var c;var d=$("shopRunnerIconCover");var e=$("BMLContainerCover");var g=$("shopRunnerDescCover");if(a=="autoContainer"){f=gnc.getAutoContainerElems();c=gnc.getIndividualContainerElems();$("autoContainer").removeClassName("inactive");$("individualContainer").addClassName("inactive");if(d){if(d.hasClassName("shopRunnerIconCoverOff")){d.removeClassName("shopRunnerIconCoverOff")}}if(e){if(e.hasClassName("BMLContainerCoverOff")){e.removeClassName("BMLContainerCoverOff")}}if(g){if(g.hasClassName("shopRunnerDescCoverOff")){g.removeClassName("shopRunnerDescCoverOff")}}}else{if(a=="individualContainer"){f=gnc.getIndividualContainerElems();c=gnc.getAutoContainerElems();$("autoContainer").addClassName("inactive");$("individualContainer").removeClassName("inactive");if(d){if(!d.hasClassName("shopRunnerIconCoverOff")){d.addClassName("shopRunnerIconCoverOff")}}if(e){if(!e.hasClassName("BMLContainerCoverOff")){e.addClassName("BMLContainerCoverOff")}}if(g){if(!g.hasClassName("shopRunnerDescCoverOff")){g.addClassName("shopRunnerDescCoverOff")}}}}var b;if(c!=null&&c.length>0){for(b=0;b<c.length;b++){(c[b]).setOpacity(0.5)}}if(f!=null&&f.length>0){for(b=0;b<f.length;b++){(f[b]).setOpacity(1)}}};gnc.getAutoContainerElems=function(){return $$("#autoContainer a.seeAllPromos","#autoContainer div.gncRecurringDetails img","#autoContainer p.saleOfferText","#autoShipFrequencySelectCombo")};gnc.getIndividualContainerElems=function(){return $$("#individualContainer a.seeAllPromos","#individualContainer div.gncRecurringDetails img","#individualContainer p.saleOfferText","#BMLContainer","#techIcon05",'div[name="sr_productDetailDiv"]')};gnc.showPopUp=function(c,a,b){remote=open(c,a,b)};gnc.showCustomPopUp=function(){remote=open("../helpdesk/popup.jsp?display=ship&subdisplay=process","availability","width=500,height=400,toolbar=no,status=no,menubar=no,scrollbars=yes,resizable=yes")};gnc.showEnhancedImage=function(){remote=open("/largeImage/index.jsp?LargeImageURL="+gnc.product.getCurrentView().enhancedImageURL,"largeImage","width=630,height=545,left=0,top=0,scrollbars")};gnc.emailAFriend=function(){remote=open("/emailAProduct/index.jsp?productId="+gnc.product.productId,"email_a_friend"+gnc.product.productId,"width=620,height=740,top=0,left=0,resizable=no,scrollbars=yes")};gnc.showReviewTab=function(){var a=$("tabRRContents");var b=$("productTabset");if(b){gnc.animatedScrollTo(b)}if(a){$$("#productTabset>dd").each(function(c,d){if(c==a){gnc.productPage.tabset.showOnlyItem(d)}})}};gnc.validateProduct=function(d,f){var e=true;var b=false;if(isNaN(parseInt(d.qty_0.value))){b=true}if(!b){for(j=0;j<d.qty_0.value.length;j++){if(isNaN(parseInt(d.qty_0.value.charAt(j)))){b=true}}}if(d.prod_0.value==""){alert("please select a size.");e=false}if(d.qty_0.value<1||d.qty_0.value=="undefined"||b){alert("Please select a quantity.");e=false}var g=document.getElementsByName("purchaseType");for(var a=0;a<g.length;a++){var c=g[a];if(c.checked&&c.value=="autoship"){d.prod_0.value=d.recprod.value;c.value=c.value+"|"+d.autoShipFrequencySelect.value}}if(e){if(f=="wishList"){d.wlName.value="default";d.async.value="0";d.submit()}else{if(gnc.miniCartActive){ajaxAddToCart(d);hideUnderElements()}else{d.submit()}}}};gnc.observeProductSkuChangeAvailMessage=function(e){if(e!=null&&e!=""&&$("availMsg")){var c=gnc.product.getSkuById(e).avail;var d=gnc.product.getSkuById(e).ship_Min;var b=gnc.product.getSkuById(e).ship_Max;var a=gnc.product.getSkuById(e).ship_Units;if((c=="ADVANCE_SALE"||c=="ADVANCED_SALE_LIMITED")){$("availMsg").innerHTML='<p><span class="textbold">AVAILABILITY:</span> BACKORDER Leaves warehouse in '+d+"-"+b+" weeks <a class=\"details\" href=\"javascript:gnc.showCustomPopUp('../helpdesk/popup.jsp?display=ship&subdisplay=process','availability','width=500,height=400,toolbar=no,status=no,menubar=no,scrollbars=yes,resizable=yes')\">Details</a></p>"}else{$("availMsg").innerHTML='<p><span class="textbold">AVAILABILITY:</span> In stock, Ships in '+d+" - "+b+" "+a+". <a class=\"details\" href=\"javascript:gnc.showCustomPopUp('../helpdesk/popup.jsp?display=ship&subdisplay=process','availability','width=500,height=400,toolbar=no,status=no,menubar=no,scrollbars=yes,resizable=yes')\">Details</a></p>"}}else{$("availMsg").innerHTML=""}};gnc.product=new gnc.Product(gnc.productJSON);if($("moreViews")){var altViewContainer=$("moreViews");var altViews=altViewContainer.getElementsByTagName("li");for(var i=0;i<altViews.length;i++){var view=altViews[i];view.getElementsByTagName("a")[0].href="javascript:gnc.product.changeView("+(i+1)+");"}altViewContainer.observeProductColorChange=function(a){a.currentView=null};$("moreViews").observeProductColorChange=function(b){var c='<li id="more0"><a href="javascript:gnc.product.changeView(0);"><img src="'+b.getCurrentColorSliceValue().thumbnailImageURL+'" alt="alternate product view" /></a></li>';for(var a=0;a<b.getCurrentColorSliceValue().alternateViews.length;a++){c=c+'<li id="more'+(a+1)+'"><a href="javascript:gnc.product.changeView('+(a+1)+');"><img src="'+b.getCurrentColorSliceValue().alternateViews[a].thumbnailImageURL+'" alt="alternate product view" /></a></li>'}$("moreViews").update(c)};gnc.product.addColorChangeListener($("moreViews"))}if($("mainProductImage")){var mainProductImage=$("mainProductImage");mainProductImage.observeProductViewChange=function(a){var b=a.getCurrentView();if(b!=null&&b.mainImageURL!=""){this.src=b.mainImageURL}else{this.src=a.mainImageURL}};gnc.product.addViewChangeListener(mainProductImage);if($("enhImgLink")){$("enhImgLink").href="javascript:gnc.showEnhancedImage()";$("enhImgLink").observeProductViewChange=function(a){if(a.getCurrentView().enhancedImageURL==""){this.style.display="none"}else{this.style.display="block"}};gnc.product.addViewChangeListener($("enhImgLink"))}}if($("color")){$("color").observe("change",function(a){gnc.product.changeColor(this.value)});$("color").observeProductColorChange=function(a){$("color").value=a.colorId};gnc.product.addColorChangeListener($("color"))}if($("availMsg")){$("availMsg").observeProductSkuChange=function(a){if(a.skuId!=null&&a.skuId!=""&&$("availMsg")){var b=a.getSkuById(a.skuId).avail;if(b=="ADVANCE_SALE"||b=="ADVANCED_SALE_LIMITED"){this.innerHTML="Advance Sale";this.style.display="block"}else{this.style.display="none"}}else{this.style.display="none"}};gnc.product.addSkuChangeListener($("availMsg"))}if($("size")){$("size").observe("change",function(a){gnc.product.changeSku(this.value)});$("size").observeProductColorChange=function(a){var b=a.getCurrentColorSliceValue();this.value=""};$("size").observeProductColorChange=function(b){var c=b.getCurrentColorSliceValue();var d="";for(var a=0;a<c.availableSkuIds.length;a++){var e=b.getSkuById(c.availableSkuIds[a]);d+='<option value="'+b.productId+"|"+e.sku_id+'">'+e.size+"</option>"}$("size").update(d)};gnc.product.addColorChangeListener($("size"));$("size").observeProductSkuChange=function(a){this.value=a.productId+"|"+a.skuId};gnc.product.addSkuChangeListener($("size"))}if(document.orderFormProd){if(document.orderFormProd.prod_0){document.orderFormProd.prod_0.observeProductSkuChange=function(a){this.value=a.productId+"|"+a.skuId};gnc.product.addSkuChangeListener(document.orderFormProd.prod_0)}}if($("quantity")){$("quantity").observe("change",function(a){gnc.product.setQuantity(this.value)});$("quantity").observeProductQtyChange=function(a){this.value=a.quantity};gnc.product.addQtyChangeListener($("quantity"))}if(gnc.product.colorSliceValues.length>0){gnc.product.changeColor(gnc.product.colorSliceValues[0].colorId)}if($("contentarea")){$("contentarea").observe("click",function(a){if(a.target.nodeName=="A"){if(a.target.href.indexOf("#showReviews")>-1){if(a.target.href.indexOf(gnc.product.productId)>-1){Event.stop(a);gnc.showReviewTab()}}}})}if($("autoShipFrequencySelectCombo")){gnc.product.shipFrequencyCombo=new Df.GncCombo("autoShipFrequencySelectCombo",{data:comboDataShipFrequency,appendto:"replenishContent",listClassName:"listshipFrequency",variableWidth:false,animate:{ease:Df.Transitions.expoOut,time:1000},maxHeight:300,scrollbar:{classNames:{y:{holder:"yHolderCombo",prev:"arrowUpCombo",next:"arrowDownCombo",area:"slideAreaCombo",marker:"markerCombo"}}}});gnc.product.shipFrequencyCombo.setPosition=function(){this.pos=$("autoShipFrequencySelectCombo").positionedOffset();this.left=this.pos[0];this.top=this.pos[1];if(Prototype.Browser.ie6){this.listHolder.style.left=this.left-23+"px"}else{this.listHolder.style.left=this.left+1+"px"}this.listHolder.style.top=this.top+22+"px"};gnc.product.shipFrequencyCombo.changeSelected=function(a){if(this.currentIndex!==a){if(this.pars.data.length>a){this.currentIndex=a;this.currentLabel=this.pars.data[this.currentIndex].label;this.currentValue=this.pars.data[this.currentIndex]["value"]}this.element.fire(":update",{currentIndex:this.currentIndex,currentLabel:this.currentLabel,currentValue:this.currentValue});if(this.pars.onUpdate){this.pars.onUpdate(this)}this.highlightSelection()}$("autoShipFrequencySelect").value=this.currentValue;gnc.setSavingsPerYear();return this};gnc.product.shipFrequencyCombo.setCurrentIndex(0)}if($("size")){gnc.product.sizeCombo=new Df.GncCombo("size",{data:comboDataView,appendto:"remindmeBlock",listClassName:"listSize",variableWidth:false,animate:{ease:Df.Transitions.expoOut,time:1000}});gnc.product.sizeCombo.setPosition=function(){this.pos=$("size").positionedOffset();this.left=this.pos[0];this.top=this.pos[1];this.listHolder.style.left=this.left+1+"px";this.listHolder.style.top=this.top+22+"px"};gnc.product.sizeCombo.changeSelected=function(a){if(this.currentIndex!==a){if(this.pars.data.length>a){this.currentIndex=a;this.currentLabel=this.pars.data[this.currentIndex].label;this.currentValue=this.pars.data[this.currentIndex]["value"]}this.element.fire(":update",{currentIndex:this.currentIndex,currentLabel:this.currentLabel,currentValue:this.currentValue});if(this.pars.onUpdate){this.pars.onUpdate(this)}this.highlightSelection()}$("prod_0").value=this.currentValue;gnc.observeProductSkuChangeAvailMessage(this.currentValue.substring(this.currentValue.indexOf("|")+1));return this};gnc.product.sizeCombo.setCurrentLabel("Select")}if($("rv-products")!=null){var rvProds=$("rv-products");var rvProdListItems=rvProds.select("li");var width=0;for(var i=0;i<rvProdListItems.length;i++){width=width+rvProdListItems[i].offsetWidth}var productSlider=$("rv-product-slider");productSlider.style.width=""+width+"px";var ins3=new Df.Slider("rv-products");ins3.pars.animate={time:100,pause:20};ins3.pars.iterateBy="li";ins3.set()}gnc.product.initializeTabset=function(){if($("productTabset")){$("productTabset").setStyle({visibility:"hidden"});var a=450;var h=680;var k=6;var n=0;var o=0;var p=0;var l=parseInt(h/$$("dl#productTabset dt").length);spanWidth=l-20;var g=-1;var d=parseInt($$("dl#productTabset dt").length);$$("dl#productTabset dt").each(function(q){q.setStyle({position:"absolute"});if(g==-1){q.setStyle({top:"0",left:"0"});g=l;q.id="first-child-curve"}else{q.setStyle({top:"0",left:g+"px"});g+=l}if(d==1){q.id="last-child-curve"}q.setStyle({width:l+"px"});q.select("span")[0].setStyle({width:spanWidth+"px"});o+=l;d-=1});$$("dl#productTabset dt").each(function(r){var q=r.getHeight();if(q>n){n=q}});var f=0;var m=0;$$("dl#productTabset dt").each(function(r){r.setStyle({height:n+"px"});var q=r.select("span")[0].getHeight();if(f==0){f=q}else{if(f>q){spamHeightMin=q}}if(m==0){m=q}else{if(m<q){m=q}}var t=(n-q)/2;r.select("span")[0].setStyle({width:spanWidth+"px",top:t+"px"})});$$("dl#productTabset dt").each(function(r){var q=r.select("span")[0];if(q.getHeight()==f){q.setStyle({textAlign:"center"})}});if(o<h){var c=h-o+l;$$("dl#productTabset dt")[$$("dl#productTabset dt").length-1].setStyle({width:c+"px"})}var e=n+k;$$("dl#productTabset dd").each(function(q){q.setStyle({top:e+"px"})});$("productTabset").setStyle({visibility:"visible"});gnc.productPage.tabset=$("productTabset").tabset();var b=window.location.toString();if(b.indexOf("#showReviews")>-1){gnc.showReviewTab()}else{gnc.productPage.tabset.showItem(0)}Event.observe("productTabset","click",function(q){$$("dl#productTabset dd").each(function(r){r.setStyle({display:"none"})})})}};Event.observe(window,"load",function(){$$("dl#productTabset dd").each(function(a){a.setStyle({display:"none"})})});if($("enlargedImageContent")){var customContent='<div id="enlargedImage"><div id="modalCloseButton"></div>'+$("enlargedImageContent").innerHTML+"</div>";[$("showEnlargedImage"),$("showEnlargedImageButton")].each(function(a){a.observe("click",function(d){if(Df.Lightbox._modal){removeDialogs()}new Ajax.Request("/product/enlargePopup.jsp?productId="+d.target.rel,{});Df.Lightbox.pars.dialog.className="df_modal_dialog";Df.Lightbox.pars.dialog.animate={opacity:1};Df.Lightbox.pars.dialog.title="";Df.Lightbox.getModal().element.setStyle({backgroundColor:"#CACCCD"});Df.Lightbox.getDialog().element.setStyle({opacity:0});Df.Lightbox._positionDialog=function(){Df.Lightbox._dialog.element.center();var f=$$(".df_modal_dialog")[0].viewportOffset().top;var e=document.body.viewportOffset().top;if($$(".df_modal_dialog")[0].viewportOffset().top<0){newTop=-e+20;$$(".df_modal_dialog")[0].setStyle({top:newTop+"px"})}};Df.Lightbox.getDialogContent().update(customContent);$("modalCloseButton").observe("click",function(){Df.Lightbox.hide()});Df.Lightbox.show();var c=$$(".df_modal_dialog")[0].viewportOffset().top;var b=document.body.viewportOffset().top;if($$(".df_modal_dialog")[0].viewportOffset().top<0){newTop=-b+20;$$(".df_modal_dialog")[0].setStyle({top:newTop+"px"})}})});removeDialogs=function(){var a=["."+Df.Lightbox.pars.dialog.className,"."+Df.Lightbox.pars.modal.className];a.each(function(b){$$(b).each(function(c){c.remove()})});Df.Lightbox._modal=false;Df.Lightbox._dialog=false;return true}}Event.observe(window,"load",function(b){Object.extend(Prototype.Browser,{IE6:Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==6,IE7:Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==7});Object.extend(Prototype.Browser,{IE8:Prototype.Browser.IE&&!(Prototype.Browser.IE6||Prototype.Browser.IE7)});if($$("#productTabset")){if($$("dl#productTabset dt").first()){$$("dl#productTabset dt").first().update($$("dl#productTabset dt").first().innerHTML+'<b class="top-left-corner">&nbsp;</b>')}if($$("dl#productTabset dt").last()){$$("dl#productTabset dt").last().update($$("dl#productTabset dt").last().innerHTML+'<b class="top-right-corner">&nbsp;</b>')}}if($("mainContent").getHeight()<450){$("mainContent").setStyle({height:"450px"})}$("mainContent").insert('<div id="expressView"><div class="toolTipBlk"></div></div>');$("expressView")._isDisplayed=false;$("expressView")._displayIntent=false;var a;$("mainContent").observe("mouseout",function(c){if(c.target.className.match(/^toolTipTrigger/)){clearTimeout(a);$("expressView")._displayIntent=false;if($("expressView")._isDisplayed&&!$("expressView")._displayIntent){$("expressView").setStyle({display:"none",top:"-10000px",left:"-10000px"});$("expressView")._isDisplayed=false}}});$("mainContent").observe("mouseover",function(f){if(f.target.className.match(/^toolTipTrigger/)){f.stop();var d=-10000;var c=-10000;$("expressView").innerHTML="";$("expressView")._displayIntent=true;a=setTimeout(function(){if((!$("expressView")._isDisplayed||$("expressView")._isDisplayed!=f.target.id)&&$("expressView")._displayIntent){if((document.body.className.indexOf("gncGoldCard")==-1)&&((f.target.className.indexOf("iconRegiment")>-1)||(f.target.className.indexOf("iconEmail")>-1)||(f.target.className.indexOf("iconPrint")>-1))){if(f.target.className.indexOf("iconRegiment")>-1){$("expressView").innerHTML='<div class="regimen">Add to My Regimen</div>'}else{if(f.target.className.indexOf("iconEmail")>-1){$("expressView").innerHTML='<div class="email">Email a friend</div>'}else{if(f.target.className.indexOf("iconPrint")>-1){$("expressView").innerHTML='<div class="printPage">Print Page</div>'}}}var g=f.target.up("li");c=new Number(g.positionedOffset().top-$("expressView").getHeight()+75);if(Prototype.Browser.ie6){d=new Number(g.positionedOffset().left+665)}else{if(Prototype.Browser.ie7){d=new Number(g.positionedOffset().left+665)}else{d=new Number(g.positionedOffset().left+680)}}}else{if((document.body.className.indexOf("gncGoldCard")>-1)&&((f.target.className.indexOf("iconRegiment")>-1)||(f.target.className.indexOf("iconEmail")>-1)||(f.target.className.indexOf("iconPrint")>-1))){if(f.target.className.indexOf("iconEmail")>-1){$("expressView").innerHTML='<div class="email">Email a friend</div>'}else{if(f.target.className.indexOf("iconPrint")>-1){$("expressView").innerHTML='<div class="printPage">Print Page</div>'}}var g=f.target.up("li");c=new Number(g.positionedOffset().top-$("expressView").getHeight()+53);d=new Number(g.positionedOffset().left+672)}else{if(f.target.className.indexOf("leftEmailIcon")>-1){$("expressView").innerHTML='<div class="email">Email a friend</div>';var g=f.target.up("li");c=new Number(g.positionedOffset().top-$("expressView").getHeight()+53);if(Prototype.Browser.ie6){d=new Number(g.positionedOffset().left+836)}else{if(Prototype.Browser.ie7){d=new Number(g.positionedOffset().left+846)}else{d=new Number(g.positionedOffset().left+846)}}}else{var h=f.target.siblings();$("expressView").innerHTML='<div class="'+h[0].className+'">'+h[0].innerHTML+"</div>";var g=f.target.up("#techIcons");var e=0;if($$("div.topPromotion")[0]){e=$$("div.topPromotion")[0].getHeight()}d=new Number(g.positionedOffset().left+8);c=new Number(g.positionedOffset().top-$("expressView").getHeight()+87)+e}}}$("expressView").setStyle({display:"block",left:d+"px",top:c+"px"});$("expressView")._isDisplayed=f.target.id}},400)}})});gnc.flashMessage=function(b,a){if(!a){a="success"}if(!$("flash-message")){$("contentarea").insert({top:'<div id="flash-message"></div>'})}$("flash-message").update(b).addClassName(a).animate({height:34});setTimeout(function(){$("flash-message").animate({height:0,onComplete:function(){$("flash-message").update("").removeClassName(a)}})},4000)};if($("icon-add-to-regimen")){(function(){$("icon-add-to-regimen").observe("click",function(a){new Ajax.Request("/community/regimen.jsp",{method:"get",parameters:{username:a.target.rel,operation:"update",pid:gnc.product.productId,status:"public"},onSuccess:function(b){$(document.body).setStyle({cursor:"default"});gnc.flashMessage(document.title+" has been added to your regimen successfully")},onFailure:function(b){$(document.body).setStyle({cursor:"default"});gnc.flashMessage("There was a error adding "+document.title+" to your regimen","error")}});$(document.body).setStyle({cursor:"wait"})})})()}Event.observe(window,"load",function(){ProductName=s.pageName.substring((s.pageName).lastIndexOf(":")+1);var b=(s.products).substring(0,((s.products).lastIndexOf(":")+0));var a=b.substring(0,(b).lastIndexOf(";"));Product=gnc.product.productId+":"+ProductName;Parentcategory=a;ReadPrdReview=$("pr-snippet-read-link-"+gnc.product.productId);if(ReadPrdReview){$("pr-snippet-read-link-"+gnc.product.productId).observe("click",function(c){c.stop();LINKNAME="Read Review";productInfoTrack(Parentcategory,Product,LINKNAME)})}});document.observe("click",function(b,a){if(a=b.findElement("#productTabset dt span")){LINKNAME=a.innerHTML;b.stop();productInfoTrack(Parentcategory,Product,LINKNAME)}if(a=b.findElement("#techIcon02")){LINKNAME="Label Logo";b.stop();productInfoTrack(Parentcategory,Product,LINKNAME)}});var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var a;var b;var c;try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");a=b.GetVariable("$version")}catch(c){}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");a="WIN 6,0,21,0";b.AllowScriptAccess="always";a=b.GetVariable("$version")}catch(c){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");a=b.GetVariable("$version")}catch(c){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");a="WIN 3,0,18,0"}catch(c){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");a="WIN 2,0,0,11"}catch(c){a=-1}}return a}function GetSwfVer(){var g=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var f=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var a=navigator.plugins["Shockwave Flash"+f].description;var e=a.split(" ");var c=e[2].split(".");var h=c[0];var b=c[1];var d=e[3];if(d==""){d=e[4]}if(d[0]=="d"){d=d.substring(1)}else{if(d[0]=="r"){d=d.substring(1);if(d.indexOf("d")>0){d=d.substring(0,d.indexOf("d"))}}else{if(d[0]=="b"){d=d.substring(1)}}}var g=h+"."+b+"."+d}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){g=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){g=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){g=2}else{if(isIE&&isWin&&!isOpera){g=ControlVersion()}}}}}return g}function DetectFlashVer(f,d,c){versionStr=GetSwfVer();if(versionStr==-1){return false}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=versionStr.split(".")}var e=versionArray[0];var a=versionArray[1];var b=versionArray[2];if(e>parseFloat(f)){return true}else{if(e==parseFloat(f)){if(a>parseFloat(d)){return true}else{if(a==parseFloat(d)){if(b>=parseFloat(c)){return true}}}}}return false}}}function AC_AddExtension(d,a){var c=d.indexOf("?");if(c!=-1){var b=d.substring(0,c);if(b.length>=a.length&&b.lastIndexOf(a)==(b.length-a.length)){return d}else{return d.replace(/\?/,a+"?")}}else{if(d.length>=a.length&&d.lastIndexOf(a)==(d.length-a.length)){return d}else{return d+a}}}function AC_Generateobj(e,d,a){var c="";if(isIE&&isWin&&!isOpera){c+="<object ";for(var b in e){c+=b+'="'+e[b]+'" '}c+=">";for(var b in d){c+='<param name="'+b+'" value="'+d[b]+'" /> '}c+="</object>"}else{c+="<embed ";for(var b in a){c+=b+'="'+a[b]+'" '}c+="> </embed>"}document.write(c)}function AC_FL_RunContent(){var a=AC_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(a.objAttrs,a.params,a.embedAttrs)}function AC_GetArgs(b,e,g,d,h){var a=new Object();a.embedAttrs=new Object();a.params=new Object();a.objAttrs=new Object();for(var c=0;c<b.length;c=c+2){var f=b[c].toLowerCase();switch(f){case"classid":break;case"pluginspage":a.embedAttrs[b[c]]=b[c+1];break;case"src":case"movie":b[c+1]=AC_AddExtension(b[c+1],e);a.embedAttrs.src=b[c+1];a.params[g]=b[c+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":a.objAttrs[b[c]]=b[c+1];break;case"id":case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":a.embedAttrs[b[c]]=a.objAttrs[b[c]]=b[c+1];break;default:a.embedAttrs[b[c]]=a.params[b[c]]=b[c+1]}}a.objAttrs.classid=d;if(h){a.embedAttrs.type=h}return a}BrowserHistoryUtils={addEvent:function(e,d,b,a){a=a||false;if(e.addEventListener){e.addEventListener(d,b,a);return true}else{if(e.attachEvent){var c=e.attachEvent("on"+d,b);return c}else{e["on"+d]=b}}}};BrowserHistory=(function(){var E={ie:false,firefox:false,safari:false,opera:false,version:-1};var c="";var d=document.location.href;var z=document.location.href;var b=document.location.hash;var h="history/historyFrame.html?";var w=-1;var H=[];var y=n(z,z+"#"+b,b);var B=[];var m=[];var k=null;var v=navigator.userAgent.toLowerCase();if(v.indexOf("opera")!=-1){E.opera=true}else{if(v.indexOf("msie")!=-1){E.ie=true;E.version=parseFloat(v.substring(v.indexOf("msie")+4))}else{if(v.indexOf("safari")!=-1){E.safari=true;E.version=parseFloat(v.substring(v.indexOf("safari")+7))}else{if(v.indexOf("gecko")!=-1){E.firefox=true}}}}if(E.ie==true&&E.version==7){window._ie_firstload=false}function p(){return document.getElementById("ie_historyFrame")}function t(){return document.getElementById("firefox_anchorDiv")}function r(){return document.getElementById("safari_formDiv")}function a(){return document.getElementById("safari_remember_field")}function q(L){if(L&&document.getElementById(L)){var I=document.getElementById(L);if(typeof I.SetVariable!="undefined"){return I}else{var K=I.getElementsByTagName("object");var J=I.getElementsByTagName("embed");if(K.length>0&&typeof K[0].SetVariable!="undefined"){return K[0]}else{if(J.length>0&&typeof J[0].SetVariable!="undefined"){return J[0]}}}}else{var K=document.getElementsByTagName("object");var J=document.getElementsByTagName("embed");if(J.length>0&&typeof J[0].SetVariable!="undefined"){return J[0]}else{if(K.length>0&&typeof K[0].SetVariable!="undefined"){return K[0]}else{if(K.length>1&&typeof K[1].SetVariable!="undefined"){return K[1]}}}}return undefined}function x(){var J=[];if(J.length==0){var I=document.getElementsByTagName("object");J=I}if(J.length==0||J[0].object==null){var I=document.getElementsByTagName("embed");J=I}return J}function g(){var J=p().contentWindow.document;var I=String(J.location.search);if(I.length==1&&I.charAt(0)=="?"){I=""}else{if(I.length>=2&&I.charAt(0)=="?"){I=I.substring(1)}}return I}function o(){var I=document.location.href.indexOf("#");return(I>=0)?document.location.href.substr(I+1):""}function f(I){if(I==""){I="#"}document.location.hash=I}function n(I,J,K){return{baseUrl:I,newUrl:J,flexAppUrl:K,title:null}}function G(O,I,Q){m=[];if(E.ie){if(Q==c&&document.location.href==z&&window._ie_firstload){d=z;return}if((!Q||Q==c)&&window._ie_firstload){I=O+"#"+c;Q=c}else{p().src=h+Q}f(Q)}else{if(B.length==0&&y.flexAppUrl==Q){y=n(O,I,Q)}else{if(B.length>0&&B[B.length-1].flexAppUrl==Q){B[B.length-1]=n(O,I,Q)}}if(E.safari){if(E.version<=419.3){var K=window.location.pathname.toString();K=K.substring(K.lastIndexOf("/")+1);r().innerHTML='<form name="historyForm" action="'+K+"#"+Q+'" method="GET"></form>';var P=window.location.search.substring(1);var L=P.split("&");for(var M=0;M<L.length;M++){var N=L[M].split("=");var J=document.createElement("input");J.type="hidden";J.name=N[0];J.value=N[1];document.forms.historyForm.appendChild(J)}document.forms.historyForm.submit()}else{top.location.hash=Q}H[history.length]=Q;A()}else{D(Q);f(Q)}}B.push(n(O,I,Q))}function A(){if(E.safari){a().value=H.join(",")}}function l(){var J=B.pop();if(!J){return}var I=B[B.length-1];if(!I&&B.length==0){I=y}m.push(J)}function C(){var I=m.pop();if(!I){return}B.push(I)}function e(){m=[]}function u(){if(E.ie){if(d!=document.location.href&&d+"#"!=document.location.href){if(E.version<7){d=document.location.href;document.location.reload()}else{if(o()!=g()){var I=h+o();p().src=I}}}}if(E.safari){if(w>=0&&history.length!=w){w=history.length;var O=H[w];if(O==""){}if(typeof BrowserHistory_multiple!="undefined"&&BrowserHistory_multiple==true){var M=x();for(var L=0;L<M.length;L++){M[L].browserURLChange(O)}}else{q().browserURLChange(O)}A()}}if(E.firefox){if(d!=document.location.href){var K=B.length;var N={back:false,forward:false,set:false};if((window.location.hash==b||window.location.href==z)&&(K==1)){N.back=true;l()}if(m.length>0){if(m[m.length-1].flexAppUrl==o()){N.forward=true;C()}}if((K>=2)&&(B[K-2])){if(B[K-2].flexAppUrl==o()){N.back=true;l()}}if(!N.back&&!N.forward){var J={back:-1,forward:-1};for(var L=0;L<B.length;L++){if(B[L].flexAppUrl==o()&&L!=(K-2)){arbitraryUrl=true;J.back=L}}for(var L=0;L<m.length;L++){if(m[L].flexAppUrl==o()&&L!=(K-2)){arbitraryUrl=true;J.forward=L}}e()}d=document.location.href;var O=o();if(O==""){}if(typeof BrowserHistory_multiple!="undefined"&&BrowserHistory_multiple==true){var M=x();for(var L=0;L<M.length;L++){M[L].browserURLChange(O)}}else{q().browserURLChange(O)}}}}function D(I){if(document.getElementsByName(I).length==0){t().innerHTML+="<a name='"+I+"'>"+I+"</a>"}}var F=function(){if(E.ie){var L=document.getElementsByTagName("script");for(var P=0,S;S=L[P];P++){if(S.src.indexOf("history.js")>-1){var N=(new String(S.src)).replace("history.js","historyFrame.html")}}h=N+"?";var I=h;var M=document.createElement("iframe");M.id="ie_historyFrame";M.name="ie_historyFrame";M.src="/include/blank.html";try{document.body.appendChild(M)}catch(Q){setTimeout(function(){document.body.appendChild(M)},0)}}if(E.safari){var K=document.createElement("div");K.id="safari_rememberDiv";document.body.appendChild(K);K.innerHTML='<input type="text" id="safari_remember_field" style="width: 500px;">';var J=document.createElement("div");J.id="safari_formDiv";document.body.appendChild(J);var R=document.createElement("div");R.id="safarireloader";var L=document.getElementsByTagName("script");for(var P=0,S;S=L[P];P++){if(S.src.indexOf("history.js")>-1){html=(new String(S.src)).replace(".js",".html")}}R.innerHTML='<iframe id="safarireloader-iframe" src="about:blank" frameborder="no" scrolling="no"></iframe>';document.body.appendChild(R);R.style.position="absolute";R.style.left=R.style.top="-9999px";M=R.getElementsByTagName("iframe")[0];if(document.getElementById("safari_remember_field").value!=""){H=document.getElementById("safari_remember_field").value.split(",")}}if(E.firefox){var O=document.createElement("div");O.id="firefox_anchorDiv";document.body.appendChild(O)}};return{historyHash:H,backStack:function(){return B},forwardStack:function(){return m},getPlayer:q,initialize:function(I){F(I)},setURL:function(I){document.location.href=I},getURL:function(){return document.location.href},getTitle:function(){return document.title},setTitle:function(K){try{B[B.length-1].title=K}catch(J){}if(E.safari){if(K==""){try{var I=window.location.href.toString();K=I.substring((I.lastIndexOf("/")+1),I.lastIndexOf("#"))}catch(J){K=""}}}document.title=K},setDefaultURL:function(M){c=M;M=o();if(E.ie){window._ie_firstload=true;var I=h+M;var K=function(){p().src=I;window.location.replace("#"+M);setInterval(u,50)};try{K()}catch(N){window.setTimeout(function(){K()},0)}}if(E.safari){w=history.length;if(H.length==0){H[w]=M;var L="#"+M;window.location.replace(L)}else{}setInterval(u,50)}if(E.firefox||E.opera){var J=new RegExp("#"+M+"$");if(window.location.toString().match(J)){}else{var L="#"+M;window.location.replace(L)}setInterval(u,50)}},setBrowserURL:function(M,I){if(E.ie&&typeof I!="undefined"){k=I}var L=document.location.href.indexOf("#");var J=L!=-1?document.location.href.substr(0,L):document.location.href;var K=J+"#"+M;if(document.location.href!=K&&document.location.href+"#"!=K){d=K;G(J,K,M);w=history.length}return false},browserURLChange:function(M){var I=null;if(E.ie&&k!=null){I=k}pendingURL="";if(typeof BrowserHistory_multiple!="undefined"&&BrowserHistory_multiple==true){var K=x();for(var J=0;J<K.length;J++){try{K[J].browserURLChange(M)}catch(L){}}}else{try{q(I).browserURLChange(M)}catch(L){}}k=null}}})();function setURL(a){document.location.href=a}function backButton(){history.back()}function forwardButton(){history.forward()}function goForwardOrBackInHistory(a){history.go(a)}document.observe("dom:loaded",function(){BrowserHistory.initialize()});